root@Rover1:/tmp/nms# python3 start_rover.py 10.0.1.10 r1
============================================================
ROVER r1 - Iniciando...
Nave-Mãe: 10.0.1.10
Intervalo de telemetria: 5 segundos
============================================================
[DEBUG] send: Iniciando envio - missionType=R, idAgent=r1, idMission=000, tamanho=1 bytes, destino=10.0.1.10:8080
[DEBUG] send: Iniciando handshake com 10.0.1.10:8080
[DEBUG] startConnection: Iniciando handshake com 10.0.1.10:8080, idAgent=r1, retryLimit=5
[DEBUG] startConnection: Enviando SYN (tentativa 1/5)
[DEBUG] startConnection: SYN-ACK recebido de 10.0.1.10:8080
[DEBUG] startConnection: Enviando ACK para completar handshake
[DEBUG] startConnection: Handshake concluído com sucesso - seq=101
[DEBUG] send: Handshake concluído - seq=101, ack=101
[DEBUG] send: Mensagem cabe num único pacote (1 bytes)
[DEBUG] send: Enviando mensagem completa (seq=101)
[DEBUG] send: ACK da mensagem recebido (seq=102), iniciando fechamento de conexão
[DEBUG] send: FIN enviado (seq=102), aguardando FIN-ACK
[DEBUG] send: FIN recebido do outro lado, enviando FIN-ACK (seq=103, ack=102)
[DEBUG] send: Conexão fechada com sucesso
[DEBUG] recv: Iniciando receção - aguardando handshake
[DEBUG] acceptConnection: Aguardando SYN...
[DEBUG] acceptConnection: Pacote recebido de 10.0.1.10:8080
[DEBUG] acceptConnection: Flag recebida: S
[DEBUG] acceptConnection: SYN recebido de 10.0.1.10:8080, idAgent=r1
[DEBUG] acceptConnection: SYN válido processado
[DEBUG] acceptConnection: Enviando SYN-ACK para 10.0.1.10:8080, idAgent=r1
[DEBUG] acceptConnection: SYN-ACK enviado, aguardando ACK
[DEBUG] acceptConnection: ACK recebido, handshake concluído - seq=100, ack=100
[DEBUG] recv: Handshake concluído - idAgent=r1, seq=100, ack=100, origem=10.0.1.10:8080
[DEBUG] recv: Aguardando primeira mensagem...
[DEBUG] recv: Primeira mensagem recebida de 10.0.1.10:8080, tamanho=29 bytes
[DEBUG] recv: Mensagem parseada - flag=D, idMission=000, seq=101, missionType=N
[DEBUG] recv: Validando primeira mensagem - IP esperado=10.0.1.10, recebido=10.0.1.10, Porta esperada=8080, recebida=8080, Seq esperado=101, recebido=101
[DEBUG] recv: Validação passou!
[DEBUG] recv: idMission extraído: 000
[DEBUG] recv: Primeira mensagem válida - missionType=N, idMission=000, seq=101
[DEBUG] recv: É uma mensagem, tamanho=10 bytes
[DEBUG] recv: ACK da primeira mensagem enviado
[DEBUG] recv: Aguardando chunks adicionais ou FIN...
[DEBUG] recv: Chunk 1 recebido de 10.0.1.10:8080, tamanho=19 bytes
[DEBUG] recv: Chunk parseado - flag=F, seq=102, esperado seq=102
[DEBUG] recv: Chunk válido recebido (seq=102, tamanho mensagem=1 bytes)
[DEBUG] recv: FIN recebido! Mensagem completa tem 10 bytes
[DEBUG] recv: Último chunk adicionado (tamanho final: 11 bytes)
[DEBUG] recv: Enviando FIN-ACK (seq=102)
[DEBUG] recv: Aguardando ACK do FIN enviado
[DEBUG] recv: ACK do FIN recebido, conexão fechada. Retornando mensagem completa (tamanho: 10 bytes)
[INFO] Rover r1 conectado à Nave-Mãe 10.0.1.10
[OK] Registado como r1 na Nave-Mãe 10.0.1.10
[DEBUG] recvMissionLink: Aguardando mensagem...
[DEBUG] recv: Iniciando receção - aguardando handshake
[DEBUG] acceptConnection: Aguardando SYN...
[DEBUG] acceptConnection: Pacote recebido de 10.0.1.10:8080
[DEBUG] acceptConnection: Flag recebida: S
[DEBUG] acceptConnection: SYN recebido de 10.0.1.10:8080, idAgent=r1
[DEBUG] acceptConnection: SYN válido processado
[DEBUG] acceptConnection: Enviando SYN-ACK para 10.0.1.10:8080, idAgent=r1
[DEBUG] acceptConnection: SYN-ACK enviado, aguardando ACK
[DEBUG] acceptConnection: ACK recebido, handshake concluído - seq=100, ack=100
[DEBUG] recv: Handshake concluído - idAgent=r1, seq=100, ack=100, origem=10.0.1.10:8080
[DEBUG] recv: Aguardando primeira mensagem...
[DEBUG] recv: Primeira mensagem recebida de 10.0.1.10:8080, tamanho=181 bytes
[DEBUG] recv: Mensagem parseada - flag=D, idMission=M-001, seq=101, missionType=T
[DEBUG] recv: Validando primeira mensagem - IP esperado=10.0.1.10, recebido=10.0.1.10, Porta esperada=8080, recebida=8080, Seq esperado=101, recebido=101
[DEBUG] recv: Validação passou!
[DEBUG] recv: idMission extraído: M-001
[DEBUG] recv: Primeira mensagem válida - missionType=T, idMission=M-001, seq=101
[DEBUG] recv: É uma mensagem, tamanho=159 bytes
[DEBUG] recv: ACK da primeira mensagem enviado
[DEBUG] recv: Aguardando chunks adicionais ou FIN...
[DEBUG] recv: Chunk 1 recebido de 10.0.1.10:8080, tamanho=21 bytes
[DEBUG] recv: Chunk parseado - flag=F, seq=102, esperado seq=102
[DEBUG] recv: Chunk válido recebido (seq=102, tamanho mensagem=1 bytes)
[DEBUG] recv: FIN recebido! Mensagem completa tem 159 bytes
[DEBUG] recv: Último chunk adicionado (tamanho final: 160 bytes)
[DEBUG] recv: Enviando FIN-ACK (seq=102)
[DEBUG] recv: Aguardando ACK do FIN enviado
[OK] Telemetria contínua ativa (intervalo: 5s)
============================================================
Rover r1 pronto!
============================================================

Rover em operação. Aguardando missões...
Pressione Ctrl+C para encerrar

[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[INFO] Telemetria enviada para 10.0.1.10
^C

A encerrar Rover r1...
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
[PACKET LOSS] Timeout ao aguardar ACK do FIN de 10.0.1.10:8080 (recv)
[RETRANSMISSÃO] Reenviando FIN para 10.0.1.10:8080
Monitorização contínua de telemetria parada
Rover r1 encerrado.
root@Rover1:/tmp/nms# 
